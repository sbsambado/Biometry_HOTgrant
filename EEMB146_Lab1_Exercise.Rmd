---
title: "EEMB146 Lab1 Exercise"
author: "Written by Sam Sambado"
date: "2023-12-28"
output:
    html_document:
      toc: true
      toc_float: true
---

## Exercise 1 - Biometry Basics

# Class Announcements

#### Welcome to EEMB 146 Computer Lab Discussions!

The purpose of these computer labs are to give you hands-on experience with the statistic the **R language** and the **RStudio environment**. This may be your first time coding or hearing about R, which is *really exciting* & will sometimes be frustrating; but that's totally normal. 

\newline
\newline

#### What to expect during computer lab discussions

These discussion sections are meant to function like office hours where **students can bring questions about homework or programming** in general. Each week the TA will prepare a mini-lesson on what to expect for the labs and common mistakes on lab assignments. The **TAs will take attendance during the first 20 minutes** of discussion, which will be part of your course participation grade. However, you are able to attend any section that works best with your schedule, just make sure you attend one section per week. You do not need to request a discussion section switch from your TAs.

\newline
\newline

#### General lab logistics

  + Each week there will be an homework assignment (i.e. Lab 2, Lab 3, etc) released on Monday for you to **complete by the following Sunday at 11:59 PM**. You are free (& encouraged) to begin the homework assignment before section on Thursday or Friday. 
  
  + For each week, there will be an **Exercise** file and **Homework** file on Canvas. The **Exercise** file will contain (i) background information on major concepts and (ii) exercises that are meant for you to read through and complete mini tasks; if you complete the exercises you will be able to answer > 98% of your homework questions. The **Homework** file contains homework questions for the week and is the only file you need to turn in for homework credit. You will be graded for completeness and correctness of your answers. 
  
  + A note about the **Exercise** files: 
    
    1) Students take Biometry for a variety of reasons. Whether you are enrolled for this class because of your degree, or you see a future need to know statistics and R programming, we want to provide resources for you that last beyond 11 weeks. The **Exercise** file is meant to be a tool kit that can be used for a honor thesis, future graduate research, or a potential data science job. 
    
    2) Students start Biometry with a wide range of skills. Whether Biometry is a totally new or old concept, we want to accommodate all learners and provide information to keep everyone interested and engaged. Exercise files may seem very long, but they are meant to encompass all types of learners in Biometry.
    
  + The **format to answer your homework questions** for Lab 2 - Lab 9 can be found on Canvas under `WEEK 2 Lab Instructions` labeled as **"Example - How to format your lab homework"**, that you can download and fill out for each week. 
  
  + To be respectful of everyone's time and availability, **your last day to receive help on graded assignments from an instructor is the Friday 10 AM computer lab**. All lab assignments will be due on Sunday at 11:59 PM. 
  
  + To be fair and consistent with extensions, **you will receive two free late homework submissions without penalty**. This policy applies only to homeworks. When you wish to use one of these late assignments, simply submit within one week of the original deadline, and **add a note** at the beginning of the assignment that this sia free late submission. Non-exempted homework submitted within one week of the deadline will be awarded 50% credit. No credit will be awarded for homework turned in more than one week late; please plan ahead and submit your work on time. Finally, there are no regrade requests more than two weeks after the assignment was graded, so please check that your work was graded correctly when you receive it. Regrades are only given when the grader has made a mistake.


# Background on R and RStudio

*note: much of this info came from other coding classes I have taken at UCSB that I highly recommend such as EEMB 179 with Dr. Holly Moeller & ESM 206 with Dr. Allison Horst*

\newline


**What is R and RStudio?**

TLDR; R is a programming language whereas RStudio is a user-friendly platform to visualize R tasks.


R is an object-oriented scripting language that combines:

+ An extensive set of functions for classical & modern **statistical data analysis & modeling**

+ Graphing functions for **visualizing data & model output**

+ **free and open source tool** to be shared with a wider internet community 

\newline


**What's the difference between .Rmd vs .html vs .R files on Canvas?**

+ Both .Rmd and .html file types contain the same information -- code we need to run & text that describes the code. However, the .Rmd file will contain extra code which formats the .html document. We will typically start in an .Rmd file to write and execute code, however once completed with code, the .html file may be more visually appealing to read. 

+ R script (.R file) have less functionality as it relates to data visualization, code organization and output generation. For this class, we will not be accepting R script completed homeworks (.R file) on Canvas.  


# Exercise 1 Instructions

#### Learning objectives

1. Become familiar with R language and RStudio environment -- at least have it **working on your personal computer**

\newline


2. **Correctly identify data types** of variables -- many questions for your Lab 1 HW Questions stem from this concept

\newline

3. Observe common **data wrangling techniques** in tidyverse -- helpful tools for future HWs 

\newline

4. Learn some common terminology in R -- to help with asking questions


\newline


### Part 1: Watch Two Tutorial videos

\newline

##### A. 'Lab 1 Tutorial Video: How to download R & RStudio' 
+ On Canvas, Under WEEK 1 COMPUTER LAB MATERIALS

##### B. 'Lab 1 Tutorial Video: Intro to R & R Studio'
+ On Canvas, Under WEEK 1 COMPUTER LAB MATERIALS


### Part 2: Download R & R Studio on your computer

##### A. [Download R here](https://cran.r-project.org/mirrors.html)  

* Click the link and scroll down to USA & choose one of the CRAN (Comprehensive R Archive Network) mirror -- I personally chose the one in my time zone (Oregon State University).  You can technically choose any mirror you'd like, however it's suggested you always use the closest server to your location.  

* Click the appropriate link depending on your operating system (Mac OS X _vs._ Windows _vs._ Linux)

    + If you're a Mac user, select R-4.3.2.pkg link for the lastest version of R "Eye Holes". 
    
    + If you're a PC user, click the "install R for the first time" link then "Download R 4.3.2 for Windows" link.

\newline

* Open your downloaded packages, agree to the license and continue downloading as usual. Find the R icon (blue R with a grey circle) in your application folder to confirm a successful download. 

* If you already have R downloaded on your computer with an older version, the new version should automatically replace your older version. 

* Let's open up R. 

##### B. [Download R studio here](https://www.rstudio.com/products/rstudio/download/)

* Click the link and select the left-most download button with under the "RStudio Desktop Open Source License" label. 

* Click the appropriate installer tab depending on your operating system (usually either of the first two installers).

* Open the installer, agree to the license and install normally. 

* Find the R studio icon (white R in a blue circle; this is different from the previous 'R' icon) in your applications folder to confirm a successful download. 

* Let's open up R studio. 

*Note: if you are having troubles downloading R or RStudio,* **please** *see your TA during discussion sections on Thursday or Friday*

### Part 3: Material for HW 1 Questions

All answers for HW 1 can be found in the text below.

#### A. The Big Picture

So much data exists in our world! With R, you have the ability to use that data to ask and answer questions. There are many ways to tell a story, but there are some general guidelines on how to build that story:

+ First ask yourself, what is your outcome of interest - your **dependent** variable 'y'?

+ Then ponder, what is influencing your outcome of interest - your **independent** variable 'x'? 


Some questions you may have that R could theoretically solve for you:

+ Does soil type (**independent**) influence tree height (**dependent**)?

+ Does the distance from ocean (**independent**) influence rent costs (**dependent**)?

+ Do twitter mentions (**independent**) influence cryptocurrency value (**dependent**)?

#### B. Your type of data determines how you can shape your story

##### Data types or classes

+ **Numerical** --> numbers, duh.
  + *example: 1, 4.03, 7000*

+ **Categorical** --> characteristics, like words.
  + *example: blue, kind, fish*

+ **Continuous** --> numbers can take on **any** value

  + *example: height, weight, temperature*
  
+ **Discrete** --> numbers or words can only be **certain** values

  + *example: days of the week, # of kids in a class, pet type*
  

+ **Factor** --> categorical grouping 
  + *example: cereals, departments, countries*
  
+ **Levels** --> categorical sub-groups of factors  
  + *example: (honey bunches of oats, cheerios), (EEMB, PSTAT, ESM), (Canada, USA, Mexico)*


+ **Nominal** --> discrete units with no order

  + *example: languages, countries, gender*
  
  
+ **Ordinal** --> discrete unites with order

  + *example: months of year, levels of education, TA reviews*


#### C. Once you understand your story, then you can hop into data wrangling - yeehaw.

\newline
\newline
\newline

Quick remark, there are many ways to wrangle data. Two common "philosophies" on data wrangling fall under **base-R** or **tidyverse**. **Base-R** works more with individual vectors whereas **tidyverse** (specifically the `dplyr` package) uses verb inputs. Both techniques will be used in this class because they **both achieve similar things**, however choose whatever method makes more intuitive sense to you. You can find more information about the differences on this [link](https://dplyr.tidyverse.org/articles/base.html).

Okay, end of philosophical ramble. Let's get started.





\newline
\newline

\newline
\newline



#### D. Intro to one of the best data wrangling tools -- Tidyverse

\newline

\newline

#### Tidyverse isn't just a package, it's a collection of packages
+ *similar to how universities (ie tidyverse) are made up of colleges (ie packages) that have specific functions*

\newline


\newline


##### Rules

+ Each **variable** has its own **column**

+ Each **observation** has its own **row**

+ Each **value** has its own **cell**

\newline

\newline

+ Data wrangling will require a lot of wrangling

\newline

\newline

##### Additional Resources - check 'em out!
*Note: Script for this workshop was largely taken from these sources*

[Basic Tidyverse Concepts](https://homerhanumat.github.io/r-notes/tidyverse-concepts.html)


[Tidyverse with animations](https://www.garrickadenbuie.com/project/tidyexplain/)


[Tidyverse-cookbook](https://rstudio-education.github.io/tidyverse-cookbook/tidy.html)


\newline
\newline



##### Core concepts and commands of tidyverse

*Note: This code serves as a template for future homework help. You don't need to type out anything. For now, just observe the code and the associated outputs. Think of these exercises as scaffolds for your future code -- no need to reinvent the wheel for any of your homework assignments, take code from your exercises to tailor it to specific homework problems.*





##### Step 0. The set up

When you open a new .Rmd file, there will always be a 'chunk' with the label '{r setup, include=FALSE}'. Within that chunk you can determine the style of how your knitted .Rmd file will look (more on that in Lab 2).
```{r setup, include=TRUE, message = FALSE, warning=FALSE}
## set your global knitting style
knitr::opts_chunk$set(echo = TRUE) # this means your code will be generated alongside your output (ie data visuals/model summaries)
knitr::opts_chunk$set(message = FALSE) # this means the message from commands won't be printed out in the .html file
knitr::opts_chunk$set(warning = FALSE) # this means the warning from commands won't be printed out in the .html file

### FYI, basic command line structure ###
    # object <- function(argument)
```


**Step 1. Libraries needed for this workshop**
```{r, message = FALSE}

# remember, install.packages("PACAKGE") then library(PACKAGE)
  ## Note: quotations for install.packages(), no quotations for libary()

# you only need to install a package once to call the library

# after you install.packages(), then hashtag # install.packages()

# install.packages("tidyverse")
library(tidyverse) # package to use tidyverse functions

# install.packages("nycflights13")
library(nycflights13) # package to call data from

# install.packages("mosaicData")
library(mosaicData) # package to call data from

```

**Step 2. Data needed for this assignment**
```{r}
## we will be using online datasets so we don't have to worry about file paths for now. There are many ways to call in data from the internet compared to when you are uploading a dataset from your own Rproj

# data from github for examples

# dataset 1 for examples
data("flights", package = "nycflights13") # data built into R for exercises

# dataset 2 for examples
data(CPS85) # comes from package `mosaicData`

```

**Step 3. Familiarize with the basics**

##### pipe operator `%>` : chains function together

```{r pipe operator}
# using pipe operator
"hello" %>% rep(times = 4)

# without pipe operator
rep("hello", times = 4)
```


##### dplyr package : tool for data manipulation

+ a. `filter()` and `select()` for sub-setting

+ b. `mutate()` for transforming variables

+ c. `group_by()` and `summarise()` for numerical summaries

+ d. `fivenum()` for all 5 summaries

\newline


Exercise a: **`filter()` and `select()`** to chose optimal observations & variables
```{r filter and select}

# we will use dataset flights that track all flights from Flights that Departed NYC in 2013

# always look at the specs (ie number of rows, columns) & variable data types of your dataset 
dim(flights) # 336776 rows, 19 columns 

str(flights) # shows the data type of each variable (column) in your dataset

## okay let's wrangle 


# usually filter() and select() are your first arguments when you get a dataset
flights %>% # call tibble
  filter(month == "6" & carrier == "UA") %>% # filter picks out rows/observations ## we're selecting observations that are month == 6 (June) AND from carrier == "UA" (United Airways)
  select(day, arr_time, dest) # selects picks out columns/variables such as day, arr_time (air time), dest (destination)


# let's leave out columns/variables ; use `-`
flights %>%
  select(-year, -month) # still have lots of columns left!


# want to see how many observations you have left post subsetting?
flights %>%
  filter(dest == "LAX" & day == "1") %>% # filtering flights that only arrived in LAX on the 1st day of each month in 2013
  nrow() # count the rows/observations left


```

Exercise b: **`mutate()`** to transform variables
```{r mutate}
# keep new variable name on LEFT side of `=`
# keep function on RIGHT side of `=` that depends on the current value in the tibble


flights %>%
  mutate(sig_delay = arr_delay > 125) %>% # make new column/variable called sig_delay ## this will provide TRUE (> 125) /FALSE (< 125) for each observation with regards to its arr_delay (air delay) value
  select(carrier, origin, distance, sig_delay) # select desired variables


# You can double dip mutations within one line of code
flights %>%
  filter(carrier == "UA" & month == "12") %>% # select for flights on UA carrier during month 12 (december - holidays)
  mutate(sig_delay = arr_delay > 200, 
         sig_delayHR = arr_delay / 60) %>% # made two new variables/columns based on previous data in column 'arr_delay' (ie transformed minutes into hours)
  ggplot(aes(x = origin, y = sig_delayHR)) + # plot these new variable values
  geom_jitter(width = 0.2, alpha = .5) + # avoid points overlapping and making them a certain size
  geom_boxplot(fill = 'burlywood', outlier.alpha = 0) + # using boxplot to visualize datat
  labs(x = "Airport Origin", y = "Time Delay (hours)") + # relabel axes to make them interpretable 
  theme_bw() + # create a clean background
  theme(axis.title = element_text(face = "bold")) # make axis title text bold

## if i had to choose an AA flight out of NYC during the december holiday month, I would probably choose JFK because it has the lowest median of time delay compared to EWR and LGA, and actually has flights leave before or exactly on time.
  
```

Exercise c:  **`group_by()` and `summarise()`** to generate numerical summaries 

```{r group_by and summarise}
# we will use dataset CPS85 from the MosaicData package that is data from the 1985 Current Population Survey

# always look at your new dataset 
  # dim(CPS85)
  # head(CPS85)


# okay let's wrangle 


CPS85 %>% # tibble that comes from the `mosaicData`
  group_by(sex) %>% # divide observations based on their values/observations in the variable 
  summarize(meanWage = mean(wage)) # make new tibble that has mean wage for each level of sex, you will only have two columns/variables in this tibble 1) sex and 2) meanWage


# create more than 1 summary variable
CPS85 %>% 
  group_by(sex) %>% 
  summarize(meanWage = mean(wage),
            n = n()) # n() is the count function, very helpful for most summaries ## will count total observations for your variable meanWage


```


Exercise d: if you want to run all 5 summaries (which you should), use `fivenum()` function

```{r other summaries}

## Option 1: summaries for entire tibble (men and women included)
CPS85 %>%
  .$wage %>% # select one column/vector of information you want to summarize
  fivenum() # run all 5 summary statistics


## Option 2: summaries broken down for each sex (more appropriate of comparisons!)
CPS85 %>%
  group_by(sex) %>% 
  summarise(n = n(), # count observations
            min = fivenum(wage)[1],
            Q1 = fivenum(wage)[2],
            median = fivenum(wage)[3],
            Q3 = fivenum(wage)[4],
            max = fivenum(wage)[5])


## Option 3: you can also compare multiple variables by group
CPS85 %>% 
  group_by(sector, sex) %>%  # looking at SEX and SECTOR
  summarise(n = n(),
            min = fivenum(wage)[1],
            Q1 = fivenum(wage)[2],
            median = fivenum(wage)[3],
            Q3 = fivenum(wage)[4],
            max = fivenum(wage)[5])
```



#### E. Common R terminology

TBH, this may seem incredibly dry when you are first learning R. However, mastery of this terminology will make coding and asking for coding help **much** easier. 

For example, if you are trying to find out "how to select for Guatemala within your country grouping", copying and pasting that question into Google may not give you many search hits. However, if you reframe your question as "How to select for a level within a factor in R" (where Guatamela is a level within the country factor), you will have many more responses to look through. 


Some important glossary words for you to keep and refer to throughout the quarter: 


+ **function**: code that performs an action, and really how you do anything in R. Usually takes an input (ie argument), does something to it and return an output (ie an output, test result, plot). There are functions for importing converting and manipulating data.

+ **argument**: an element of a function, either essential or optional, that informs or alters how the function works. For instance, it can be a file path where the function should import from or save to : function(argument = `file = \"file-path\"`)

+ **package**: a bundle of functions that provide functionality to R. Many packagages come automatically with R, others you have to download for specific needs: install.packages(package = "tidyverse")

+ **working directory**: the folder on your computer linked to your current R session, where you import data from and save files to. 

+ **script**: similar to a text editor (ie Microsoft Word), this is where you write and save your code for future reference. It contains a mix of code and comments and is saved as a simple text file that you can easily share so that anyone can reproduce your work.


+ **command**: a chunk of code that performs an action, typically contains one or more functions. You run a command by pressing "Run" or using a keyboard shortcut like Cmd+Enter, Ctrl+Enter or Ctrl+R

+ **comment**: a bit of text in a script that starts with a hashtag (#) and isn't read as a command. Comments make your code readable to other people: use them to create sections in your script and to annotate each sep of your analysis


+ **csv file**: a type of file commonly used to import data in R, where the values of different variables are compressed together (a string, or line of values per row) and separated only by commas, R can also accept Excel (.xlsx) files, but we don't recommend it as formatting errors are harder to avoid.

+ **data frame**: a type of R object which consists of many rows and columns; think Excel spreadsheet. Usually the columns are different variables (ie age, color, weight, wingspan), and rows are observations of these variables (ie bird1, bird2, bird3)

+ **class**: the type of data contained in a variable: usually character (text/words), numeric (number), integer (whole numbers), or factor (grouping values, useful when you have multiple observation for sites or treatments in your data).


+ **object**: the building blocks of R. If R was a spoken language, functions would be verbs (action) and onjects would be nouns (the subjects of these actions). Objects are called by typing their name without quotation marks. Objects store data and can take different forms. 



Definitions taken from [Stats from Scratch](https://ourcodingclub.github.io/course/stats-scratch/index.html)

#### Huzzah - the end of Lab 1 Exercise material! 
